<!DOCTYPE html>
<html>
<head>
  <title>Trein Configuration</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 10px;
      background-color: #fff;
      color: #000;
    }

    a {
      color: #0000EE;
    }

    .item {
      margin-bottom: 15px;
    }

    label {
      display: block;
      margin-bottom: 5px;
    }

    input, select {
      width: 95%;
      padding: 5px;
      border: 1px solid #ccc;
      border-radius: 3px;
      background-color: #fff;
      color: #000;
    }

    button {
      padding: 10px;
      border: 0;
      background: #000;
      color: #fff;
      border-radius: 3px;
    }

    .add-btn {
      width: auto;
      padding: 5px 15px;
      margin-left: 5px;
    }

    .favourite-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px;
      margin: 5px 0;
      background: #f5f5f5;
      border-radius: 3px;
    }

    .remove-btn {
      padding: 5px 10px;
      background: #c00;
      font-size: 12px;
    }

    .station-row {
      display: flex;
      align-items: center;
    }

    .station-select {
      flex: 1;
    }

    #favourites-list {
      margin: 10px 0;
    }

    .hint {
      font-size: 12px;
      color: #666;
      margin-top: 5px;
    }

    @media (prefers-color-scheme: dark) {
      body {
        background-color: #121212;
        color: #eee;
      }

      a {
        color: #bb86fc;
      }

      input, select {
        background-color: #333;
        color: #eee;
        border-color: #555;
      }

      button {
        background: #bb86fc;
        color: #121212;
      }

      .favourite-item {
        background: #2a2a2a;
      }

      .hint {
        color: #999;
      }
    }
  </style>
</head>
<body>
  <h1>Trein Configuration</h1>
  You can register here to request a free API key: <a href="https://apiportal.ns.nl"> apiportal.ns.nl </a>
  <br><br>
  <div class="item">
    <label for="api_key_input">NS API Key</label>
    <input type="text" id="api_key_input" placeholder="Enter your personal API key">
  </div>

  <h2>Favourite Stations</h2>
  <p class="hint">Add up to 5 favourite stations. These will appear at the top of station lists.</p>
  <div class="item">
    <div class="station-row">
      <select id="station_select" class="station-select">
        <option value="">Select a station...</option>
      </select>
      <button id="add_favourite_button" class="add-btn">Add</button>
    </div>
    <div id="favourites-list"></div>
  </div>

  <button id="save_button">Save</button>

  <script>
    // All Dutch train stations
    var ALL_STATIONS = [
      {"code":"ATN","name":"Aalten"},{"code":"AC","name":"Abcoude"},{"code":"AKM","name":"Akkrum"},{"code":"RTA","name":"Alexander"},{"code":"AMRN","name":"Alkmaar N"},{"code":"AMR","name":"Alkmaar"},{"code":"AML","name":"Almelo"},{"code":"ALM","name":"Almere C"},{"code":"APN","name":"Alphen"},{"code":"AMF","name":"Amersfoort C"},{"code":"ASA","name":"Amstel"},{"code":"ASD","name":"Amsterdam C"},{"code":"ASDZ","name":"Amsterdam Z"},{"code":"ANA","name":"Anna Paulowna"},{"code":"APD","name":"Apeldoorn"},{"code":"APG","name":"Appingedam"},{"code":"AKL","name":"Arkel"},{"code":"ARN","name":"Arnemuiden"},{"code":"AH","name":"Arnhem C"},{"code":"AHZ","name":"Arnhem Z"},{"code":"ASN","name":"Assen"},{"code":"SDTB","name":"Baanhoek"},{"code":"BRN","name":"Baarn"},{"code":"BF","name":"Baflo"},{"code":"BRD","name":"Barendrecht"},{"code":"BNC","name":"Barneveld C"},{"code":"BNN","name":"Barneveld N"},{"code":"BNZ","name":"Barneveld Z"},{"code":"BDM","name":"Bedum"},{"code":"BK","name":"Beek-Elsloo"},{"code":"BSD","name":"Beesd"},{"code":"BL","name":"Beilen"},{"code":"BGN","name":"Bergen op Zoom"},{"code":"BET","name":"Best"},{"code":"BV","name":"Beverwijk"},{"code":"ASB","name":"Bijlmer ArenA"},{"code":"BHV","name":"Bilthoven"},{"code":"RTB","name":"Blaak"},{"code":"HBZM","name":"Blauwe Zoom"},{"code":"BR","name":"Blerick"},{"code":"BLL","name":"Bloemendaal"},{"code":"BDG","name":"Bodegraven"},{"code":"BN","name":"Borne"},{"code":"BSK","name":"Boskoop"},{"code":"BHDV","name":"Boven-Hardinxveld"},{"code":"BKF","name":"Bovenkarspel Flora"},{"code":"BKG","name":"Bovenkarspel-Grootebroek"},{"code":"BMR","name":"Boxmeer"},{"code":"BTL","name":"Boxtel"},{"code":"HMBV","name":"Brandevoort"},{"code":"BD","name":"Breda"},{"code":"BKL","name":"Breukelen"},{"code":"HMBH","name":"Brouwhuis"},{"code":"BMN","name":"Brummen"},{"code":"ALMB","name":"Buiten"},{"code":"BP","name":"Buitenpost"},{"code":"BDE","name":"Bunde"},{"code":"BNK","name":"Bunnik"},{"code":"BSMZ","name":"Bussum Zuid"},{"code":"LWC","name":"Camminghaburen"},{"code":"HTNC","name":"Castellum"},{"code":"CAS","name":"Castricum"},{"code":"CVM","name":"Chevremont"},{"code":"CO","name":"Coevorden"},{"code":"DVC","name":"Colmschate"},{"code":"CK","name":"Cuijk"},{"code":"CL","name":"Culemborg"},{"code":"DA","name":"Daarlerveen"},{"code":"DLN","name":"Dalen"},{"code":"DL","name":"Dalfsen"},{"code":"DEI","name":"Deinum"},{"code":"DDN","name":"Delden"},{"code":"DTCP","name":"Delft Campus"},{"code":"DT","name":"Delft"},{"code":"DZW","name":"Delfzijl West"},{"code":"DZ","name":"Delfzijl"},{"code":"HT","name":"Den Bosch"},{"code":"DLD","name":"Den Dolder"},{"code":"GVC","name":"Den Haag C"},{"code":"HDR","name":"Den Helder"},{"code":"DN","name":"Deurne"},{"code":"DV","name":"Deventer"},{"code":"DID","name":"Didam"},{"code":"DMNZ","name":"Diemen Zuid"},{"code":"DMN","name":"Diemen"},{"code":"DR","name":"Dieren"},{"code":"HTO","name":"Den Bosch Oost"},{"code":"GV","name":"Den Haag HS"},{"code":"HDRZ","name":"Den Helder Zuid"},{"code":"DTC","name":"Doetinchem"},{"code":"DDZD","name":"Dordrecht Zuid"},{"code":"DDR","name":"Dordrecht"},{"code":"DB","name":"Driebergen-Zeist"},{"code":"DRH","name":"Driehuis"},{"code":"DRP","name":"Dronryp"},{"code":"DRON","name":"Dronten"},{"code":"DVN","name":"Duiven"},{"code":"DVD","name":"Duivendrecht"},{"code":"NMD","name":"Dukenburg"},{"code":"EC","name":"Echt"},{"code":"EDC","name":"Ede C"},{"code":"ED","name":"Ede-Wageningen"},{"code":"EEM","name":"Eemshaven"},{"code":"EDN","name":"Eijsden"},{"code":"EHV","name":"Eindhoven C"},{"code":"EST","name":"Elst"},{"code":"EMNZ","name":"Emmen Zuid"},{"code":"EMN","name":"Emmen"},{"code":"EKZ","name":"Enkhuizen"},{"code":"ES","name":"Enschede"},{"code":"EML","name":"Ermelo"},{"code":"ESE","name":"Eschmarke"},{"code":"ETN","name":"Etten-Leur"},{"code":"GERP","name":"Europapark"},{"code":"EGHM","name":"Eygelshoven Markt"},{"code":"EGH","name":"Eygelshoven"},{"code":"FWD","name":"Feanwalden"},{"code":"FN","name":"Franeker"},{"code":"GDR","name":"Gaanderen"},{"code":"GDM","name":"Geldermalsen"},{"code":"GP","name":"Geldrop"},{"code":"GLN","name":"Geleen Oost"},{"code":"LUT","name":"Geleen-Lutterade"},{"code":"HGLG","name":"Gezondheidspark"},{"code":"GZ","name":"Gilze-Rijen"},{"code":"GBR","name":"Glanerbrug"},{"code":"GS","name":"Goes"},{"code":"NMGO","name":"Goffert"},{"code":"GO","name":"Goor"},{"code":"GR","name":"Gorinchem"},{"code":"GD","name":"Gouda"},{"code":"GDG","name":"Goverwelle"},{"code":"GBG","name":"Gramsbergen"},{"code":"GK","name":"Grijpskerk"},{"code":"GN","name":"Groningen"},{"code":"GNN","name":"Groningen Noord"},{"code":"GW","name":"Grou-Jirnsum"},{"code":"HLM","name":"Haarlem"},{"code":"HWZB","name":"Halfweg-Zwanenburg"},{"code":"HDE","name":"'t Harde"},{"code":"HDB","name":"Hardenberg"},{"code":"HD","name":"Harderwijk"},{"code":"GND","name":"Hardinxveld-Giessendam"},{"code":"HRN","name":"Haren"},{"code":"HLGH","name":"Harlingen Haven"},{"code":"HLG","name":"Harlingen"},{"code":"HK","name":"Heemskerk"},{"code":"HAD","name":"Heemstede-Aerdenhout"},{"code":"HR","name":"Heerenveen"},{"code":"HWD","name":"Heerhugowaard"},{"code":"HRLW","name":"Heerlen Woonboulevard"},{"code":"HRL","name":"Heerlen"},{"code":"HZE","name":"Heeze"},{"code":"HLO","name":"Heiloo"},{"code":"HNO","name":"Heino"},{"code":"HM","name":"Helmond"},{"code":"HMN","name":"Hemmen-Dodewaard"},{"code":"HGLO","name":"Hengelo Oost"},{"code":"HGL","name":"Hengelo"},{"code":"NMH","name":"Heyendaal"},{"code":"HIL","name":"Hillegom"},{"code":"HVS","name":"Hilversum"},{"code":"HNP","name":"Hindeloopen"},{"code":"HB","name":"Hoensbroek"},{"code":"HVL","name":"Hoevelaken"},{"code":"HOR","name":"Hollandsche Rading"},{"code":"ASHD","name":"Holendrecht"},{"code":"HON","name":"Holten"},{"code":"HFD","name":"Hoofddorp"},{"code":"HGV","name":"Hoogeveen"},{"code":"HGZ","name":"Hoogezand-Sappemeer"},{"code":"HKS","name":"Hoogkarspel"},{"code":"HNK","name":"Hoorn Kersenboogerd"},{"code":"HN","name":"Hoorn"},{"code":"HRT","name":"Horst-Sevenum"},{"code":"HMH","name":"'t Hout"},{"code":"HTN","name":"Houten"},{"code":"SGL","name":"Houthem-St. Gerlach"},{"code":"DTCH","name":"De Huet"},{"code":"HDG","name":"Hurdegaryp"},{"code":"IJT","name":"IJlst"},{"code":"KPNZ","name":"Kampen Zuid"},{"code":"KPN","name":"Kampen"},{"code":"BZL","name":"Kapelle-Biezelinge"},{"code":"ESK","name":"Kennispark"},{"code":"KRD","name":"Kerkrade C"},{"code":"KTR","name":"Kesteren"},{"code":"KBK","name":"Klarenbeek"},{"code":"KMR","name":"Klimmen-Ransdaal"},{"code":"KLP","name":"De Klomp"},{"code":"ZDK","name":"Kogerveld"},{"code":"KZ","name":"Koog aan de Zaan"},{"code":"KMW","name":"Koudum-Molkwerum"},{"code":"KBD","name":"Krabbendijke"},{"code":"KMA","name":"Krommenie-Assendelft"},{"code":"KW","name":"Kropswolde"},{"code":"KRG","name":"Kruiningen-Yerseke"},{"code":"LAA","name":"Laan van NOI"},{"code":"ZLW","name":"Lage Zwaluwe"},{"code":"LG","name":"Landgraaf"},{"code":"LLZM","name":"Lansingerland-Zoetermeer"},{"code":"LDM","name":"Leerdam"},{"code":"LW","name":"Leeuwarden"},{"code":"LEDN","name":"Leiden C"},{"code":"LDL","name":"Leiden Lammenschans"},{"code":"UTLR","name":"Leidsche Rijn"},{"code":"ASDL","name":"Lelylaan"},{"code":"LLS","name":"Lelystad C"},{"code":"NML","name":"Lent"},{"code":"LTV","name":"Lichtenvoorde-Groenlo"},{"code":"LC","name":"Lochem"},{"code":"RLB","name":"Lombardijen"},{"code":"LP","name":"Loppersum"},{"code":"UTLN","name":"Lunetten"},{"code":"LTN","name":"Lunteren"},{"code":"MZ","name":"Maarheeze"},{"code":"MRN","name":"Maarn"},{"code":"MAS","name":"Maarssen"},{"code":"MTN","name":"Maastricht Noord"},{"code":"MT","name":"Maastricht"},{"code":"UTM","name":"Maliebaan"},{"code":"MG","name":"Mantgum"},{"code":"GVM","name":"Mariahoeve"},{"code":"MRB","name":"Marienberg"},{"code":"MTH","name":"Martenshoek"},{"code":"APDM","name":"De Maten"},{"code":"HVSM","name":"Media Park"},{"code":"MES","name":"Meerssen"},{"code":"MP","name":"Meppel"},{"code":"MDB","name":"Middelburg"},{"code":"GVMW","name":"Moerwijk"},{"code":"MMLH","name":"Mook-Molenhoek"},{"code":"ASDM","name":"Muiderpoort"},{"code":"ALMM","name":"Muziekwijk"},{"code":"NDB","name":"Naarden-Bussum"},{"code":"NWK","name":"Nieuwerkerk a/d IJssel"},{"code":"NKK","name":"Nijkerk"},{"code":"NM","name":"Nijmegen"},{"code":"NVD","name":"Nijverdal"},{"code":"NS","name":"Nunspeet"},{"code":"NH","name":"Nuth"},{"code":"NA","name":"Nieuw Amsterdam"},{"code":"NVP","name":"Nieuw Vennep"},{"code":"NSCH","name":"Nieuweschans"},{"code":"OBD","name":"Obdam"},{"code":"OT","name":"Oisterwijk"},{"code":"ODZ","name":"Oldenzaal"},{"code":"OST","name":"Olst"},{"code":"OMN","name":"Ommen"},{"code":"OTB","name":"Oosterbeek"},{"code":"ALMO","name":"Oostvaardersplassen"},{"code":"OP","name":"Opheusden"},{"code":"OW","name":"Oss West"},{"code":"O","name":"Oss"},{"code":"APDO","name":"Osseveld"},{"code":"ODB","name":"Oudenbosch"},{"code":"UTO","name":"Overvecht"},{"code":"OVN","name":"Overveen"},{"code":"PMO","name":"Overwhere"},{"code":"ALMP","name":"Parkwijk"},{"code":"TPSW","name":"Passewaaij"},{"code":"AMPO","name":"Poort"},{"code":"AHPR","name":"Presikhaaf"},{"code":"BDPB","name":"Prinsenbeek"},{"code":"PMR","name":"Purmerend"},{"code":"PT","name":"Putten"},{"code":"RAT","name":"Raalte"},{"code":"RAI","name":"RAI"},{"code":"MTR","name":"Randwyck"},{"code":"RVS","name":"Ravenstein"},{"code":"TBR","name":"Reeshof"},{"code":"RV","name":"Reuver"},{"code":"RH","name":"Rheden"},{"code":"RHN","name":"Rhenen"},{"code":"AMRI","name":"De Riet"},{"code":"RSN","name":"Rijssen"},{"code":"RSW","name":"Rijswijk"},{"code":"RB","name":"Rilland-Bath"},{"code":"RM","name":"Roermond"},{"code":"RD","name":"Roodeschool"},{"code":"RSD","name":"Roosendaal"},{"code":"RS","name":"Rosmalen"},{"code":"RTD","name":"Rotterdam C"},{"code":"RTN","name":"Rotterdam Noord"},{"code":"RTZ","name":"Rotterdam Zuid"},{"code":"RL","name":"Ruurlo"},{"code":"SPTN","name":"Santpoort Noord"},{"code":"SPTZ","name":"Santpoort Zuid"},{"code":"SSH","name":"Sassenheim"},{"code":"SWD","name":"Sauwerd"},{"code":"SGN","name":"Schagen"},{"code":"SDA","name":"Scheemda"},{"code":"SDM","name":"Schiedam C"},{"code":"SOG","name":"Schin op Geul"},{"code":"SN","name":"Schinnen"},{"code":"SHL","name":"Schiphol"},{"code":"CPS","name":"Schollevaar"},{"code":"AMFS","name":"Schothorst"},{"code":"ASSP","name":"Science Park"},{"code":"STD","name":"Sittard"},{"code":"SDT","name":"Sliedrecht"},{"code":"ASS","name":"Sloterdijk"},{"code":"SKND","name":"Sneek Noord"},{"code":"SK","name":"Sneek"},{"code":"BSKS","name":"Snijdelwijk"},{"code":"STZ","name":"Soest Zuid"},{"code":"ST","name":"Soest"},{"code":"SD","name":"Soestdijk"},{"code":"VSS","name":"Souburg"},{"code":"HLMS","name":"Spaarnwoude"},{"code":"SBK","name":"Spaubeek"},{"code":"HVSP","name":"Sportpark"},{"code":"RTST","name":"Stadion"},{"code":"ZLSH","name":"Stadshagen"},{"code":"DDRS","name":"Stadspolders"},{"code":"STV","name":"Stavoren"},{"code":"STM","name":"Stedum"},{"code":"SWK","name":"Steenwijk"},{"code":"EHS","name":"Strijp-S"},{"code":"SRN","name":"Susteren"},{"code":"SM","name":"Swalmen"},{"code":"TG","name":"Tegelen"},{"code":"TBG","name":"Terborg"},{"code":"UTT","name":"Terwijde"},{"code":"TL","name":"Tiel"},{"code":"TBU","name":"Tilburg Universiteit"},{"code":"TB","name":"Tilburg"},{"code":"WADT","name":"Triangel"},{"code":"TWL","name":"Twello"},{"code":"UTG","name":"Uitgeest"},{"code":"UHZ","name":"Uithuizen"},{"code":"UHM","name":"Uithuizermeeden"},{"code":"UST","name":"Usquert"},{"code":"UT","name":"Utrecht C"},{"code":"UTVR","name":"Vaartsche Rijn"},{"code":"VK","name":"Valkenburg"},{"code":"VSV","name":"Varsseveld"},{"code":"AVAT","name":"Vathorst"},{"code":"VDM","name":"Veendam"},{"code":"VNDC","name":"Veenendaal C"},{"code":"VNDW","name":"Veenendaal West"},{"code":"VP","name":"Velp"},{"code":"AHP","name":"Velperpoort"},{"code":"VL","name":"Venlo"},{"code":"VRY","name":"Venray"},{"code":"DVNK","name":"De Vink"},{"code":"VLB","name":"Vierlingsbeek"},{"code":"VTN","name":"Vleuten"},{"code":"VS","name":"Vlissingen"},{"code":"VDL","name":"Voerendaal"},{"code":"VB","name":"Voorburg"},{"code":"VH","name":"Voorhout"},{"code":"VST","name":"Voorschoten"},{"code":"VEM","name":"Voorst-Empe"},{"code":"VD","name":"Vorden"},{"code":"VZ","name":"Vriezenveen"},{"code":"VHP","name":"Vroomshoop"},{"code":"VG","name":"Vught"},{"code":"WADN","name":"Waddinxveen Noord"},{"code":"WAD","name":"Waddinxveen"},{"code":"WFM","name":"Warffum"},{"code":"WT","name":"Weert"},{"code":"WP","name":"Weesp"},{"code":"WL","name":"Wehl"},{"code":"PMW","name":"Weidevenne"},{"code":"DWE","name":"De Westereen"},{"code":"WTV","name":"Westervoort"},{"code":"WZ","name":"Wezep"},{"code":"WDN","name":"Wierden"},{"code":"WC","name":"Wijchen"},{"code":"WH","name":"Wijhe"},{"code":"WS","name":"Winschoten"},{"code":"WSM","name":"Winsum"},{"code":"WWW","name":"Winterswijk West"},{"code":"WW","name":"Winterswijk"},{"code":"WD","name":"Woerden"},{"code":"WF","name":"Wolfheze"},{"code":"WV","name":"Wolvega"},{"code":"WK","name":"Workum"},{"code":"WM","name":"Wormerveer"},{"code":"YPB","name":"Ypenburg"},{"code":"ZD","name":"Zaandam"},{"code":"ZZS","name":"Zaanse Schans"},{"code":"ZBM","name":"Zaltbommel"},{"code":"ZVT","name":"Zandvoort"},{"code":"ZA","name":"Zetten-Andelst"},{"code":"ZV","name":"Zevenaar"},{"code":"ZVB","name":"Zevenbergen"},{"code":"ZTM","name":"Zoetermeer"},{"code":"ZTMO","name":"Zoetermeer Oost"},{"code":"ZB","name":"Zuidbroek"},{"code":"ZH","name":"Zuidhorn"},{"code":"UTZL","name":"Zuilen"},{"code":"ZP","name":"Zutphen"},{"code":"ZWD","name":"Zwijndrecht"},{"code":"ZL","name":"Zwolle"}
    ];

    var favourites = [];
    var MAX_FAVOURITES = 5;

    function getUrlParams() {
      var params = {};
      var parts = window.location.search.substring(1).split('&');
      for (var i = 0; i < parts.length; i++) {
        var nv = parts[i].split('=');
        if (!nv[0]) continue;
        params[nv[0]] = nv[1] || true;
      }
      return params;
    }

    function populateStationSelect() {
      var select = document.getElementById('station_select');
      for (var i = 0; i < ALL_STATIONS.length; i++) {
        var option = document.createElement('option');
        option.value = ALL_STATIONS[i].code;
        option.textContent = ALL_STATIONS[i].name;
        select.appendChild(option);
      }
    }

    function renderFavourites() {
      var list = document.getElementById('favourites-list');
      list.innerHTML = '';

      for (var i = 0; i < favourites.length; i++) {
        var item = document.createElement('div');
        item.className = 'favourite-item';

        var name = document.createElement('span');
        name.textContent = favourites[i].name;

        var removeBtn = document.createElement('button');
        removeBtn.className = 'remove-btn';
        removeBtn.textContent = 'Remove';
        removeBtn.dataset.index = i;
        removeBtn.addEventListener('click', function() {
          var idx = parseInt(this.dataset.index);
          favourites.splice(idx, 1);
          renderFavourites();
        });

        item.appendChild(name);
        item.appendChild(removeBtn);
        list.appendChild(item);
      }
    }

    function addFavourite() {
      if (favourites.length >= MAX_FAVOURITES) {
        alert('Maximum ' + MAX_FAVOURITES + ' favourites allowed.');
        return;
      }

      var select = document.getElementById('station_select');
      var code = select.value;
      if (!code) {
        alert('Please select a station.');
        return;
      }

      // Check for duplicates
      for (var i = 0; i < favourites.length; i++) {
        if (favourites[i].code === code) {
          alert('Station already in favourites.');
          return;
        }
      }

      // Find station name
      var name = '';
      for (var j = 0; j < ALL_STATIONS.length; j++) {
        if (ALL_STATIONS[j].code === code) {
          name = ALL_STATIONS[j].name;
          break;
        }
      }

      favourites.push({code: code, name: name});
      renderFavourites();
      select.value = '';
    }

    document.addEventListener('DOMContentLoaded', function() {
      populateStationSelect();

      var params = getUrlParams();
      if (params.api_key) {
        document.getElementById('api_key_input').value = decodeURIComponent(params.api_key);
      }
      if (params.favourites) {
        try {
          favourites = JSON.parse(decodeURIComponent(params.favourites));
          renderFavourites();
        } catch (e) {
          console.log('Error parsing favourites: ' + e);
        }
      }

      document.getElementById('add_favourite_button').addEventListener('click', addFavourite);
    });

    document.getElementById('save_button').addEventListener('click', function() {
      var apiKey = document.getElementById('api_key_input').value;

      var settings = {
        'api_key': apiKey,
        'favourites': favourites
      };

      var location = 'pebblejs://close#' + encodeURIComponent(JSON.stringify(settings));
      document.location = location;
    });
  </script>
</body>
</html>
